<script src="https://mozilla.github.io/nunjucks/files/nunjucks.min.js"></script>
<script>

function parseData(){
  var specifications = JSON.parse(document.getElementById(types.specifications.data).getAttribute('data'));
  var labels = JSON.parse(document.getElementById(types.labels.data).getAttribute('data'));
  var requirements = JSON.parse(document.getElementById(types.requirements.data).getAttribute('data'));
  var groups = JSON.parse(document.getElementById(types.groups.data).getAttribute('data'));
  var states = JSON.parse(document.getElementById(types.states.data).getAttribute('data'));
  var tags = JSON.parse(document.getElementById(types.tags.data).getAttribute('data'));
  var files = JSON.parse(document.getElementById(types.files.data).getAttribute('data'));
  var users = JSON.parse(document.getElementById(types.users.data).getAttribute('data'));

  return {
			'specifications': specifications,
			'labels': labels,
			'requirements': requirements,
			'groups': groups,
			'states': states,
			'tags': tags,
			'files': files,
			'users': users
		}
}

function genFromTemplate(){
  all_data = parseData()
  google.script.run.withSuccessHandler(html => {
    console.log(html);
    google.script.run.withSuccessHandler(id => {
      console.log(id);
    }).saveConvertHtmlDrive(
      nunjucks.renderString(html, {all_data})
    )
  }
  ).getGoogleDocumentAsHTML();


}


</script>