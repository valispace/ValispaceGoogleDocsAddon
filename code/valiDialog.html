<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
  </head>
  <body>
  
    <div>
       <?!=vali.name?>
    </div>
   
    
    <table cellpadding="100">
      <tr>
        <td><input type="radio" name="valitype" value="value" checked></td>
        <td>Value</td>
        <td><?!=vali.value?> <?!=vali.unit?></td>
      </tr>
      <tr>
        <td><input type="radio" name="valitype" value="wc_plus" ></td>
        <td>Worst case plus</td>
        <td><?!=vali.wc_plus?> <?!=vali.unit?></td>
      </tr>
      <tr>
        <td><input type="radio" name="valitype" value="wc_minus" ></td>
        <td>Worst case minus</td>
        <td><?!=vali.wc_minus?> <?!=vali.unit?></td>
      </tr>
      <tr>
        <td><input type="radio" name="valitype" value="margin_plus" ></td>
        <td>Margin plus</td>
        <td><?!=vali.margin_plus?> %</td>
      </tr>
      <tr>
        <td><input type="radio" name="valitype" value="margin_minus" ></td>
        <td>Margin minus</td>
        <td><?!=vali.margin_minus?> %</td>
      </tr>
      <tr>
        <td><input type="radio" name="valitype" value="totalmargin_plus" ></td>
        <td>Total margin plus</td>
        <td><?!=vali.totalmargin_plus?> %</td>
      </tr>
      <tr>
        <td><input type="radio" name="valitype" value="totalmargin_minus" ></td>
        <td>Total margin minus</td>
        <td><?!=vali.totalmargin_minus?> %</td>
      </tr>
    </table>
    
    <div style="padding-top:15px ; padding-bottom:15px">
    <input  type="checkbox" id="displayUnit" value="displayUnit" checked>Display unit<br>
    </div>
    <input type="submit" value="Submit" class="action" onclick="form_data()" >
    <input type="button" value="Close" onclick="google.script.host.close()" >
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
    </script>
    <script>
      function form_data(){
        var link = <?=link?>;
        var vali = <?=JSON.stringify(vali)?>;
        var field = $("input[name=valitype]:checked").val();
        var displayUnit =  $("#displayUnit").is(':checked');
        google.script.run.withSuccessHandler(closeIt).insertValiWithParams(link, vali, field, displayUnit);
      };
      function closeIt(){
        google.script.host.close()
      };
      
    </script>
    <style>
     th, td {
       padding-left: 15px;
       text-align: left;
     }
    </style>
    
  </body>
</html>