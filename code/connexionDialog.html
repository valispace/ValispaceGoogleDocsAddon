<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h2> Connect to Valispace</h2>
    <div>
      <label for="deployment">Deployment Name:</label>
      <input type="text" id="deployment" name="deployment" value="demo">
    </div>
    <div>
      <label for="username">Username:</label>
      <input type="text" id="username" name="username">
    </div>

  <div>
    <label for="pass">Password:</label>
    <input type="password" id="pass" name="password">
  </div>

    <input type="submit" value="Connect" class="action" onclick="connect()" >
    <input type="button" value="Close" onclick="google.script.host.close()" >
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
    </script>
    <script>
      function connect(){
        var username = 
        google.script.run
          .withSuccessHandler(closeIt)
          .withFailureHandler(function(error){
            alert(error);
          })
          .valispaceAskToken($('#deployment').val(), $('#username').val(), $('#pass').val());
      };
      function closeIt(){
        google.script.host.close()
      };
      
    </script>
  </body>
</html>